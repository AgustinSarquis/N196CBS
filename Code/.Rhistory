TCS <- TAGB + TBB + TDM
return(data.frame(
t = t,
TAGB = TAGB,
TBB = TBB,
TDM = TDM,
TCS = TCS
))
}
TCS_values2 <- TCS_model2(time_series)
TCS_values2 <- TCS_model2(t)
# The model
soilmodel=Model(t, A, ivList, inputFluxes)
# Get stocks dynamics
Ct=cbind(rowSums(getC(soilmodel)),getC(soilmodel))
# We use data from Eucalyptus plantations in Hawai'i
AGB=337.6 # aboveground biomass (tons ha-1) lidar data obtained by Hayley
BGB=mean(c(22.4, 66)) # belowground biomass (tons ha-1) averaged from Reeves 2012 thesis and Selments et al. 2017
DM=12 # dead mass (tons ha-1) from Reeves 2012 thesis
# Forest model from Sierra et al. 2012 without the soil compartment adjusted to Hawai'i data
forestmodel <- function(t) {
TAGB <- AGB * (1 - exp(-0.064 * t))^1.964
TBB <- BGB * (1 - exp(-0.022 * t))^0.897
TDM <- DM / (1 + 2.363 * exp(-0.062 * t))
TCS <- TAGB + TBB + TDM
return(data.frame(
t = t,
TAGB = TAGB,
TBB = TBB,
TDM = TDM,
TCS = TCS
))
}
# Forest model from Sierra et al. 2012 without the soil compartment adjusted to Hawai'i data
forestmodel <- function(t) {
TAGB <- AGB * (1 - exp(-0.064 * t))^1.964
TBB <- BGB * (1 - exp(-0.022 * t))^0.897
TDM <- DM / (1 + 2.363 * exp(-0.062 * t))
TCS <- TAGB + TBB + TDM
return(data.frame(
t = t,
TAGB = TAGB,
TBB = TBB,
TDM = TDM,
TCS = TCS
))
}
forestvalues <- forestmodel(t)
View(forestvalues)
# Plot the results
matplot(forestvalues$t,forestvalues[,2:5], type="l", lty=1,lwd=3, col=c(2:4,1),ylim=c(0,max(TCS_values2)),
ylab="Carbon stocks (Ton C/ha)", xlab="Time (years)")
legend("topleft",c("TAGB", "TBB","TDM","TCS"),lty=1,col=c(2:4,1), lwd=3, bty="n")
# Now imagine all trees are harvested at once and turned into biochar
# We use Eucalyptus grandis aboveground carbon from the forest model at year 60
AGC60=forestvalues$TAGB[60]
biochartotal=AGC60*yield*biocharC
# since this simulation starts 60 years after the previous one, we use those stocks at year 60 as initial conditions for this, plus biochar
ivListb=c(getC(soilmodel)[60,],20)
# this amount of biochar is above the maximum application threshold (20 Mg ha-1, Wang et al. 2016),
# we can then apply 20 Mg ha-1 and send the rest to OKFarms for composting (coming soon)
# new soil model with a new pool that represents a single application of biochar (decay rate from Wang et al. 2016)
# this asumes that changing the vegetation and applying biochar does not change the behavior of the soil. CAN BE IMPROVED!
Ab=matrix(c(-0.135, 0, 0, 0.135*0.9958, 0, 0,
0, -0.0033, 0, 0, 0.0033*0.8433, 0,
0, 0, -0.008, 0, 0.008*0.0277, 0,
0, 0, 0, -0.0032, 0, 0,
0, 0, 0, 0, -0.001, 0,
0, 0, 0, 0, 0, -0.004), nrow=6)
# FOR NOW KUKUI INPUTS ARE EQUAL TO EUCALYPTUS', BUT CAN BE IMPROVED
inputFluxesb=c(inputFluxes,0)
soilmodelb=Model(tb, Ab, ivListb, inputFluxesb)
Ctb=cbind(rowSums(getC(soilmodelb)),getC(soilmodelb))
matplot(tb,Ctb, type="l", lty=1,lwd=3, col=1:7,ylim=c(0,max(Ctb)),
ylab="Carbon stocks (Ton C/ha)", xlab="Time (years)")
##################################################################
# Kukui growth model (only aboveground biomass)
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB
))
}
wooddensities=c(230, 310, 330, 440, 490)/1000 # wood density from Krisnawati et al. 2011
# this simulation starts in 2025, so it's only 76 years
tb=seq(2025:2100)
kukuivalues = lapply(wooddensities, function (density) kukui_model(tb, density))
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Plot the results
matplot(t,kukuivalues[[5]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass (kg/ha)", xlab="Time (years)")
# Plot the results
matplot(tb,kukuivalues[[5]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass (kg/ha)", xlab="Time (years)")
lines(t,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(t,kukuivalues[[2]]$AGB, type="l", lty=1, col = 3, lwd=3)
lines(t,kukuivalues[[3]]$AGB, type="l", lty=1, col = 4, lwd=3)
lines(t,kukuivalues[[4]]$AGB, type="l", lty=1, col = 5, lwd=3)
lines(tb,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[2]]$AGB, type="l", lty=1, col = 3, lwd=3)
lines(tb,kukuivalues[[3]]$AGB, type="l", lty=1, col = 4, lwd=3)
lines(tb,kukuivalues[[4]]$AGB, type="l", lty=1, col = 5, lwd=3)
legend("topleft",c("230 kg/m3", "310 kg/m3", "330 kg/m3", "440 kg/m3", "490 kg/m3"),lty=1,col=c(2:5,1), lwd=3, bty="n")
wooddensities=c(wooddensities, mean(wooddensities))
wooddensities
i
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Plot the results for different values of wood density (as a sensitivity analysis)
matplot(tb,kukuivalues[[6]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass (kg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[2]]$AGB, type="l", lty=1, col = 3, lwd=3)
lines(tb,kukuivalues[[3]]$AGB, type="l", lty=1, col = 4, lwd=3)
lines(tb,kukuivalues[[4]]$AGB, type="l", lty=1, col = 5, lwd=3)
lines(tb,kukuivalues[[5]]$AGB, type="l", lty=1, col = 6, lwd=3)
legend("topleft",c("average","230 kg/m3", "310 kg/m3", "330 kg/m3", "440 kg/m3", "490 kg/m3"),lty=1,col=c(2:5,1), lwd=3, bty="n")
# Plot the results for different values of wood density (as a sensitivity analysis)
matplot(tb,kukuivalues[[6]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass (kg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[2]]$AGB, type="l", lty=1, col = 3, lwd=3)
lines(tb,kukuivalues[[3]]$AGB, type="l", lty=1, col = 4, lwd=3)
lines(tb,kukuivalues[[4]]$AGB, type="l", lty=1, col = 5, lwd=3)
lines(tb,kukuivalues[[5]]$AGB, type="l", lty=1, col = 6, lwd=3)
legend("topleft",c("average","230 kg/m3", "310 kg/m3", "330 kg/m3", "440 kg/m3", "490 kg/m3"),lty=1,col=c(1:6), lwd=3, bty="n")
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for different values of wood density (as a sensitivity analysis)
matplot(tb,kukuivalues[[6]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass carbon (kg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[2]]$AGB, type="l", lty=1, col = 3, lwd=3)
lines(tb,kukuivalues[[3]]$AGB, type="l", lty=1, col = 4, lwd=3)
lines(tb,kukuivalues[[4]]$AGB, type="l", lty=1, col = 5, lwd=3)
lines(tb,kukuivalues[[5]]$AGB, type="l", lty=1, col = 6, lwd=3)
legend("topleft",c("average","230 kg/m3", "310 kg/m3", "330 kg/m3", "440 kg/m3", "490 kg/m3"),lty=1,col=c(1:6), lwd=3, bty="n")
traits <- read.delim("C:/Users/musi/Desktop/traits.txt")
View(traits)
traitlist=c(
"Plant biomass and allometry: Coarse root dry mass per plant",
"Plant biomass and allometry: Fine root dry mass per plant",
"Plant biomass and allometry: Leaf dry mass per plant",
"Plant biomass and allometry: Root dry mass per plant",
"Wood (heartwood) carbon (C) content per heartwood dry mass"
"Wood (sapwood) carbon (C) content per dry mass",
traitlist=c(
"Plant biomass and allometry: Coarse root dry mass per plant",
"Plant biomass and allometry: Fine root dry mass per plant",
"Plant biomass and allometry: Leaf dry mass per plant",
"Plant biomass and allometry: Root dry mass per plant",
"Wood (heartwood) carbon (C) content per heartwood dry mass",
"Wood (sapwood) carbon (C) content per dry mass",
"Twig carbon content per twig dry mass",
"Stem sapwood carbon (C) content: empirical form factor for calculation"
"Stem carbon (C) content per stem dry mass"	,
traitlist=c(
"Plant biomass and allometry: Coarse root dry mass per plant",
"Plant biomass and allometry: Fine root dry mass per plant",
"Plant biomass and allometry: Leaf dry mass per plant",
"Plant biomass and allometry: Root dry mass per plant",
"Wood (heartwood) carbon (C) content per heartwood dry mass",
"Wood (sapwood) carbon (C) content per dry mass",
"Twig carbon content per twig dry mass",
"Stem sapwood carbon (C) content: empirical form factor for calculation"	,
"Stem carbon (C) content per stem dry mass"	,
"Root growth: root carbon (C) production per ground area and time",
"Root exudation: carbon (C) exudation as fraction of root carbon (C) growth",
"Root exudation: carbon (C) exudation as fraction of root dry mass",
"Root decomposition: fraction of carbon (C) remaining",
"Root carbon (C) content per root dry mass",
"Root carbon (C) content per ground area"	,
"Plant carbon (C) allocation to root, stem, leaves",
"Plant carbon (C) allocation: aboveground/belowground net primary production (NPP) ratio",
"Plant carbon (C) content per plant dry mass",
"Litter decomposition: fraction of carbon (C) remaining"	,
"Litter (other than leaf: twigs, bark, flowersâ€¦) carbon (C) content per litter dry mass",
"Litter (leaf) carbon (C) content per leaf litter dry mass"	,
"Litter (fine root) carbon (C) content per fine root litter dry mass"	,
"Fine root growth: fine root carbon (C) production per ground area and time"	,
"Fine root exudation: carbon (C) exudation as fraction of fine root dry mass"	,
"Fine root decomposition: fraction carbon (C) remaining"	)
trait_ids <- traits$TraitID[match(traitlist, traits$Trait)]
trait_ids
39079 <- read.delim("~/GitHub/N196CBS/Spreadsheets/TRY Request/39079.txt")
mflflkmflkgmfkgl
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597# From Waring & Powers 2017
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB
BGB = BGB
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597# From Waring & Powers 2017
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB
))
}
wooddensities=c(wooddensities, mean(wooddensities))
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
View(kukuivalues)
TCS = AGB + BGB
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
wooddensities
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597# From Waring & Powers 2017 CAN BE IMPROVED
TCS = AGB + BGB
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
legend("topleft",c("Total", "Aboveground", "Belowground"),lty=1,col=c(1:3), lwd=3, bty="n")
tb
forestvalues$TCS[,60:136]
forestvalues$TCS[60:136]
# Plot the results
matplot(forestvalues$t,forestvalues[,2:5], type="l", lty=1,lwd=3, col=c(2:4,1),ylim=c(0,max(TCS_values2)),
ylab="Carbon stocks (Ton C/ha)", xlab="Time (years)")
legend("right",c("TAGB", "TBB","TDM","TCS"),lty=1,col=c(2:4,1), lwd=3, bty="n")
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597# From Waring & Powers 2017 CAN BE IMPROVED
TCS =(AGB + BGB)/1000 # transform to Mg from kg
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# wood density from Krisnawati et al. 2011 (kg/m3)
wooddensities=c(230, 310, 330, 440, 490)
wooddensities=c(wooddensities, mean(wooddensities))
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for different values of wood density (as a sensitivity analysis)
matplot(tb,kukuivalues[[6]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass carbon (Mg/ha)", xlab="Time (years)")
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
legend("topleft",c("Total", "Aboveground", "Belowground"),lty=1,col=c(1:3), lwd=3, bty="n")
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- (0.0673 * (d*DBH^2*HEIGHT)^0.976 )/1000 # from Chave et al. 2014
BGB =   (0.016*DBH^2.597) /1000# From Waring & Powers 2017 CAN BE IMPROVED
TCS =AGB + BGB
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for different values of wood density (as a sensitivity analysis)
matplot(tb,kukuivalues[[6]]$AGB, type="l", lty=1,lwd=3,
ylab="Aboveground biomass carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[1]]$AGB, type="l", lty=1, col = 2, lwd=3)
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- (0.0673 * (d*DBH^2*HEIGHT)^0.976 )/1000 # from Chave et al. 2014
BGB =   (0.016*DBH^2.597) /1000 # From Waring & Powers 2017 CAN BE IMPROVED
TCS = AGB + BGB
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
View(kukuivalues)
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597  # From Waring & Powers 2017 CAN BE IMPROVED
TCS = AGB + BGB
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# wood density from Krisnawati et al. 2011 (kg/m3)
wooddensities=c(230, 310, 330, 440, 490)
wooddensities=c(wooddensities, mean(wooddensities))/1000
# CAN BE IMPROVED: KUKUI CARBON CONTENT
kukuivalues = lapply(wooddensities*0.45 # convert to carbon (standard placeholder for now)
, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model. Also, Kukui C content
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023 (in cm)
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023 (in m)
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014
BGB =   0.016*DBH^2.597  # From Waring & Powers 2017 CAN BE IMPROVED
TCS = (AGB + BGB)*0.45 # convert to carbon (standard placeholder for now)
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
kukuivalues = lapply(wooddensities
, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB, type="l", lty=1, col = 3, lwd=3)
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB*0.45, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB*0.45, type="l", lty=1, col = 3, lwd=3)
legend("topleft",c("Total", "Aboveground", "Belowground"),lty=1,col=c(1:3), lwd=3, bty="n")
# wood density from Krisnawati et al. 2011 (kg/m3)
wooddensities=c(230, 310, 330, 440, 490)
wooddensities=c(wooddensities, mean(wooddensities))
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB*0.45, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB*0.45, type="l", lty=1, col = 3, lwd=3)
# wood density from Krisnawati et al. 2011 (kg/m3)
wooddensities=c(230, 310, 330, 440, 490)
wooddensities=c(wooddensities, mean(wooddensities))/1000
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model. Also, Kukui C content
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023 (in cm)
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023 (in m)
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014 (in kg/ha)
BGB =   0.016*DBH^2.597  # From Waring & Powers 2017 (in kg/ha) CAN BE IMPROVED
TCS = (AGB + BGB)*0.45 # convert to carbon (standard placeholder for now)
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB,
BGB = BGB,
TCS = TCS
))
}
# wood density from Krisnawati et al. 2011
wooddensities=c(230, 310, 330, 440, 490) # (kg/m3)
wooddensities=c(wooddensities, mean(wooddensities))/1000 # divide by 1000 because in the model it is in g/cm3
# this simulation starts in 2025, so it's only 76 years
tb=seq(2025:2100)
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB*0.45, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB*0.45, type="l", lty=1, col = 3, lwd=3)
# Imagine Eucalyptus are cleared and turned into biochar (see script soilmodel.R)
# In that place, Kukui (Aleurites moluccanus) are planted as an agroforestry management
# growth model (only aboveground biomass)
# CAN BE IMPROVED: could try different belowground models. Also, lacking dead biomass model. Also, Kukui C content
# transform to Mg from kg dividing by 1000
kukuimodel <- function(t, d) {
DBH <- -9.021135 + 16.757157 * log(t) # from Lincoln 2023 (in cm)
HEIGHT <- -3.635323 + 8.5568025 * log(t) # from Lincoln 2023 (in m)
AGB <- 0.0673 * (d*DBH^2*HEIGHT)^0.976  # from Chave et al. 2014 (in kg/ha)
BGB =   0.016*DBH^2.597  # From Waring & Powers 2017 (in kg/ha) CAN BE IMPROVED
TCS = (AGB + BGB)*0.45 # convert to carbon (standard placeholder for now)
return(data.frame(
t = t,
DBH = DBH,
HEIGHT = HEIGHT,
AGB = AGB/1000, # convert to Mg from kg
BGB = BGB/1000,
TCS = TCS/1000
))
}
kukuivalues = lapply(wooddensities, function (density) kukuimodel(tb, density))
# Plot the results for average wood density
matplot(tb,kukuivalues[[6]]$TCS, type="l", lty=1,lwd=3,
ylab="Total Kukui carbon (Mg/ha)", xlab="Time (years)")
lines(tb,kukuivalues[[6]]$AGB*0.45, type="l", lty=1, col = 2, lwd=3)
lines(tb,kukuivalues[[6]]$BGB*0.45, type="l", lty=1, col = 3, lwd=3)
legend("topleft",c("Total", "Aboveground", "Belowground"),lty=1,col=c(1:3), lwd=3, bty="n")
kukuivalues[[1]]$HEIGHT
forestvalues$TDM
# Plot the results
matplot(forestvalues$t,forestvalues[,2:5], type="l", lty=1,lwd=3, col=c(2:4,1),ylim=c(0,max(TCS_values2)),
ylab=" Eucalyptus Carbon stocks (Ton C/ha)", xlab="Time (years)")
legend("right",c("TAGB", "TBB","TDM","TCS"),lty=1,col=c(2:4,1), lwd=3, bty="n")
